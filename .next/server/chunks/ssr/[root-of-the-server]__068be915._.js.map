{"version":3,"sources":["turbopack:///[project]/lib/db.ts","turbopack:///[project]/backend/profit-engine.ts","turbopack:///[project]/components/PlanCard.tsx","turbopack:///[project]/pages/plans.tsx","turbopack:///[project]/node_modules/next/dist/src/build/templates/pages.ts"],"sourcesContent":["import { supabase } from './supabase';\n\nexport type WalletRow = {\n  id: string;\n  user_id: string;\n  currency: 'USD' | 'EUR' | 'NGN' | 'BTC' | 'ETH';\n  balance: number;\n};\n\nexport type InvestmentRow = {\n  id: string;\n  user_id: string;\n  plan_id: 'starter' | 'pro' | 'elite';\n  amount_usd: number;\n  status: 'active' | 'completed' | 'pending';\n};\n\nexport async function getCurrentUserId(): Promise<string | null> {\n  const { data } = await supabase.auth.getSession();\n  return data.session?.user?.id ?? null;\n}\n\nexport async function getUserWallets(userId: string): Promise<WalletRow[]> {\n  // First try client-side read (requires RLS policies). If empty or blocked, fallback to server API.\n  const { data, error } = await supabase\n    .from('wallets')\n    .select('id,user_id,currency,balance')\n    .eq('user_id', userId);\n  const direct = (data ?? []) as WalletRow[];\n  if (!error && direct.length > 0) return direct;\n  try {\n    const { data: session } = await supabase.auth.getSession();\n    const token = session.session?.access_token;\n    if (!token) return direct; // cannot fallback without token\n    const res = await fetch(`/api/user/wallets?ts=${Date.now()}`, {\n      headers: { Authorization: `Bearer ${token}` },\n      // Ensure no caching by intermediaries\n      cache: 'no-store',\n    });\n    if (!res.ok) return direct;\n    const payload = await res.json();\n    return (payload.wallets ?? []) as WalletRow[];\n  } catch {\n    return direct;\n  }\n}\n\nexport async function getUserInvestments(userId: string): Promise<InvestmentRow[]> {\n  const { data, error } = await supabase\n    .from('investments')\n    .select('id,user_id,plan_id,amount_usd,status')\n    .eq('user_id', userId);\n  if (error) return [];\n  return (data ?? []) as InvestmentRow[];\n}\n\nexport async function upsertReferral(userId: string, code: string) {\n  const { data, error } = await supabase\n    .from('referrals')\n    .upsert({ user_id: userId, code }, { onConflict: 'user_id' })\n    .select();\n  if (error) return null;\n  return data?.[0] ?? null;\n}\n\nexport async function getReferralByUser(userId: string) {\n  const { data } = await supabase\n    .from('referrals')\n    .select('code,total_earnings')\n    .eq('user_id', userId)\n    .limit(1)\n    .maybeSingle();\n  return data ?? null;\n}\n","import type { Balance, Plan } from '../types';\n\nexport const PLANS: Plan[] = [\n  {\n    id: 'starter',\n    name: 'Starter',\n    description: 'Entry plan allocating 70% Ads & Tasks and 30% Trading.',\n    weeklyRoi: 30, // mid of 21–40% range; actual ROI comes from admin streams\n    features: ['70% Ads & Tasks', '30% Trading', 'Task bonuses available']\n  },\n  {\n    id: 'pro',\n    name: 'Pro',\n    description: 'Balanced plan: 60% Trading, 25% Copy-Trading, 15% Ads & Tasks.',\n    weeklyRoi: 35, // mid of 25–45% range\n    features: ['60% Trading', '25% Copy-Trading', '15% Ads & Tasks', 'Premium education content']\n  },\n  {\n    id: 'elite',\n    name: 'Elite',\n    description: 'High-tier: 50% Trading, 30% Staking/Yield, 20% AI/Copy-Trading.',\n    weeklyRoi: 40, // mid of 30–50% range\n    features: ['Priority withdrawals', 'Beta access to new features', '50% Trading', '30% Staking/Yield', '20% AI/Copy-Trading']\n  }\n];\n\nexport type ReferralConfig = {\n  starter: number;\n  pro: number;\n  elite: number;\n};\n\nexport const referralConfig: ReferralConfig = { starter: 5, pro: 7, elite: 10 };\n\nexport function calculateWeeklyROI(amountUSD: number, planId: string): number {\n  const plan = PLANS.find(p => p.id === planId);\n  if (!plan) return 0;\n  const roi = amountUSD * (plan.weeklyRoi / 100);\n  return Number(roi.toFixed(2));\n}\n\nexport function calculateReferralCommission(downlineWeeklyRoiUSD: number, planId: string): number {\n  const pct = planId === 'pro' ? referralConfig.pro : planId === 'elite' ? referralConfig.elite : referralConfig.starter;\n  const commission = downlineWeeklyRoiUSD * (pct / 100);\n  return Number(commission.toFixed(2));\n}\n\n// Placeholder for cron / scheduled profit distribution\nexport async function distributeWeeklyProfits() {\n  // TODO: integrate with DB (Supabase) to: \n  // 1) fetch active investments\n  // 2) compute ROI per plan\n  // 3) credit wallets for profits and referrals\n  // 4) record transactions and update balances\n  return { ok: true, message: 'Scheduled distribution stub executed.' };\n}\n","import React from 'react';\nimport { motion } from 'framer-motion';\nimport { Plan } from '../types';\n\ntype Props = {\n  plan: Plan;\n  onInvest?: (planId: string) => void;\n};\n\nexport default function PlanCard({ plan, onInvest }: Props) {\n  return (\n    <motion.div\n      className=\"card-neon flex flex-col\"\n      initial={{ opacity: 0, y: 12 }}\n      animate={{ opacity: 1, y: 0 }}\n      whileHover={{ scale: 1.02 }}\n      transition={{ duration: 0.4, ease: 'easeOut' }}\n    >\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-xl font-bold neon-text\">{plan.name}</h3>\n        <span className=\"text-neon-blue font-semibold\">{plan.weeklyRoi}% weekly</span>\n      </div>\n      <p className=\"mt-2 text-sm text-white/70\">{plan.description}</p>\n\n      <ul className=\"mt-4 space-y-1 text-sm text-white/80 list-disc list-inside\">\n        {plan.features.map((f) => (\n          <li key={f}>{f}</li>\n        ))}\n      </ul>\n\n      <button\n        className=\"btn-neon mt-6\"\n        onClick={() => onInvest?.(plan.id)}\n      >\n        Invest in {plan.name}\n      </button>\n    </motion.div>\n  );\n}\n","import PlanCard from '../components/PlanCard';\nimport { PLANS } from '../backend/profit-engine';\nimport { getCurrentUserId } from '../lib/db';\n\nexport default function Plans() {\n  const invest = async (planId: string) => {\n    try {\n      const userId = await getCurrentUserId();\n      if (!userId) {\n        alert('Please login to invest.');\n        return;\n      }\n      const res = await fetch('/api/deposit', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId, amount: 100, currency: 'USD', provider: 'flutterwave', planId })\n      });\n      const data = await res.json();\n      alert(data.message || 'Deposit initiated');\n    } catch (e) {\n      alert('Failed to initiate deposit');\n    }\n  };\n\n  return (\n    <div>\n      <h2 className=\"text-3xl font-bold neon-text mb-6\">Choose your plan</h2>\n      <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {PLANS.map((plan) => (\n          <PlanCard key={plan.id} plan={plan} onInvest={invest} />\n        ))}\n      </div>\n      <div className=\"mt-8 card-neon\">\n        <h3 className=\"font-semibold\">Revenue Streams by Plan</h3>\n        <ul className=\"mt-2 text-sm text-white/80 space-y-1 list-disc list-inside\">\n          <li>Starter: 70% Ads & Tasks, 30% Trading</li>\n          <li>Pro: 60% Trading, 25% Copy-Trading, 15% Ads & Tasks</li>\n          <li>Elite: 50% Trading, 30% Staking/Yield, 20% AI/Copy-Trading</li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n","import { PagesRouteModule } from '../../server/route-modules/pages/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\n\nimport { hoist } from './helpers'\n\n// Import the app and document modules.\nimport * as document from 'VAR_MODULE_DOCUMENT'\nimport * as app from 'VAR_MODULE_APP'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getHandler } from '../../server/route-modules/pages/pages-handler'\n\n// Re-export the component (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export methods.\nexport const getStaticProps = hoist(userland, 'getStaticProps')\nexport const getStaticPaths = hoist(userland, 'getStaticPaths')\nexport const getServerSideProps = hoist(userland, 'getServerSideProps')\nexport const config = hoist(userland, 'config')\nexport const reportWebVitals = hoist(userland, 'reportWebVitals')\n\n// Re-export legacy methods.\nexport const unstable_getStaticProps = hoist(\n  userland,\n  'unstable_getStaticProps'\n)\nexport const unstable_getStaticPaths = hoist(\n  userland,\n  'unstable_getStaticPaths'\n)\nexport const unstable_getStaticParams = hoist(\n  userland,\n  'unstable_getStaticParams'\n)\nexport const unstable_getServerProps = hoist(\n  userland,\n  'unstable_getServerProps'\n)\nexport const unstable_getServerSideProps = hoist(\n  userland,\n  'unstable_getServerSideProps'\n)\n\n// Create and export the route module that will be consumed.\nexport const routeModule = new PagesRouteModule({\n  definition: {\n    kind: RouteKind.PAGES,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  components: {\n    // default export might not exist when optimized for data only\n    App: app.default,\n    Document: document.default,\n  },\n  userland,\n})\n\nexport const handler = getHandler({\n  srcPage: 'VAR_DEFINITION_PAGE',\n  config,\n  userland,\n  routeModule,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n})\n"],"names":["PagesRouteModule","RouteKind","hoist","document","app","userland","getHandler","getStaticProps","getStaticPaths","getServerSideProps","config","reportWebVitals","unstable_getStaticProps","unstable_getStaticPaths","unstable_getStaticParams","unstable_getServerProps","unstable_getServerSideProps","routeModule","definition","kind","PAGES","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","components","App","default","Document","handler","srcPage"],"mappings":"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","ignoreList":[4]}