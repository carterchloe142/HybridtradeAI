module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},75050,a=>{"use strict";var b=a.i(8171),c=a.i(27669),d=a.i(76165);function e({children:a}){let[e,f]=(0,c.useState)("loading");return((0,c.useEffect)(()=>{let a=!0;return async function(){let{data:b}=await d.supabase.auth.getSession(),c=b.session?.user;if(!c){a&&f("noauth");return}let{data:e}=await d.supabase.from("profiles").select("role,is_admin").eq("user_id",c.id).maybeSingle(),g=!!e?.is_admin||"admin"===String(e?.role||"").toLowerCase();a&&f(g?"ok":"forbidden")}(),()=>{a=!1}},[]),"loading"===e)?(0,b.jsx)("div",{className:"p-6",children:"Checking permissions…"}):"noauth"===e?(0,b.jsx)("div",{className:"p-6",children:"Sign in required."}):"forbidden"===e?(0,b.jsx)("div",{className:"p-6",children:"Not authorized."}):(0,b.jsx)(b.Fragment,{children:a})}a.s(["default",()=>e])},22574,a=>{"use strict";var b=a.i(8171),c=a.i(76165),d=a.i(1257);function e({onQuickRun:a}){async function e(){await c.supabase.auth.signOut(),window.location.href="/auth/login"}return(0,b.jsxs)("div",{className:"glass rounded-2xl p-4 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-bold neon-text",children:"Admin Panel"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(d.default,{href:"/admin/performance",className:"btn-neon",children:"Update Performance"}),a&&(0,b.jsx)("button",{className:"btn-neon",onClick:a,children:"Quick Run Profit"}),(0,b.jsx)("button",{className:"btn-neon",onClick:e,children:"Logout"})]})]})}a.s(["default",()=>e])},89021,a=>{"use strict";var b=a.i(8171),c=a.i(1257);let d=[{path:"/admin",label:"Dashboard",icon:"dashboard"},{path:"/admin/users",label:"Users",icon:"users"},{path:"/admin/kyc",label:"KYC",icon:"shield"},{path:"/admin/deposits",label:"Deposits",icon:"deposit"},{path:"/admin/withdrawals",label:"Withdrawals",icon:"withdraw"},{path:"/admin/profit-engine",label:"ProfitEngine",icon:"profit"},{path:"/admin/performance",label:"Performance",icon:"chart"},{path:"/admin/plans",label:"Plans",icon:"plans"},{path:"/admin/transactions",label:"Transactions",icon:"ledger"},{path:"/admin/proof",label:"Proof",icon:"proof"},{path:"/admin/support",label:"Support",icon:"support"},{path:"/admin/settings",label:"Settings",icon:"settings"},{path:"/admin/logs",label:"Logs",icon:"logs"}];function e(){return(0,b.jsx)("aside",{className:"p-4 glass rounded-2xl min-h-[60vh]",children:(0,b.jsx)("nav",{className:"space-y-2",children:d.map(a=>(0,b.jsx)(c.default,{href:a.path,className:"block px-3 py-2 rounded-lg hover:bg-white/10",children:(0,b.jsx)("span",{className:"text-white/90",children:a.label})},a.path))})})}a.s(["default",()=>e],89021)},42178,a=>{"use strict";var b=a.i(79168),c=a.i(27068),d=a.i(32759),e=a.i(39141),f=a.i(67298),g=a.i(8171),h=a.i(27669),i=a.i(75050),j=a.i(22574),k=a.i(89021),l=a.i(76165);function m(){let[a,b]=(0,h.useState)([]),[c,d]=(0,h.useState)(""),[e,f]=(0,h.useState)(""),[m,n]=(0,h.useState)(null),[o,p]=(0,h.useState)(!1),[q,r]=(0,h.useState)(!1);async function s(){p(!0),n(null);try{let{data:a}=await l.supabase.auth.getSession(),b=a.session?.access_token;if(!b)throw Error("Missing session token");let e=await fetch("/api/admin/users/invite-admin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({email:c.trim()})}),f=await e.json();if(!e.ok)throw Error(f?.error||"Invite failed");n(`Invited ${f.invited?.email||c} and promoted to admin.`),d("")}catch(a){n(a?.message||"Error inviting admin")}finally{p(!1)}}async function t(){r(!0),n(null);try{let{data:a}=await l.supabase.auth.getSession(),b=a.session?.access_token;if(!b)throw Error("Missing session token");let c=await fetch("/api/admin/users/promote",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({userId:e.trim()})}),d=await c.json();if(!c.ok)throw Error(d?.error||"Promotion failed");n(`Promoted user ${e} to admin.`),f("")}catch(a){n(a?.message||"Error promoting admin")}finally{r(!1)}}return(0,h.useEffect)(()=>{(async()=>{try{let{data:a}=await l.supabase.from("profiles").select("user_id,role,is_admin").or("is_admin.eq.true,role.eq.admin");b(a||[])}catch(a){}})()},[]),(0,g.jsx)(i.default,{children:(0,g.jsxs)("div",{className:"grid md:grid-cols-[260px,1fr] gap-6 p-6",children:[(0,g.jsx)("div",{children:(0,g.jsx)(k.default,{})}),(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsx)(j.default,{}),(0,g.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,g.jsxs)("div",{className:"card-neon",children:[(0,g.jsx)("h3",{className:"font-semibold",children:"Invite Admin by Email"}),(0,g.jsx)("p",{className:"mt-2 text-sm text-white/80",children:"Sends an invite email and auto-promotes the user."}),(0,g.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,g.jsx)("input",{className:"input-neon flex-1",placeholder:"admin@example.com",value:c,onChange:a=>d(a.target.value)}),(0,g.jsx)("button",{className:"btn-neon",disabled:o||!c,onClick:s,children:o?"Inviting...":"Invite"})]})]}),(0,g.jsxs)("div",{className:"card-neon",children:[(0,g.jsx)("h3",{className:"font-semibold",children:"Promote Existing User"}),(0,g.jsx)("p",{className:"mt-2 text-sm text-white/80",children:"Enter a user ID from Supabase Auth → Users."}),(0,g.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,g.jsx)("input",{className:"input-neon flex-1",placeholder:"UUID user ID",value:e,onChange:a=>f(a.target.value)}),(0,g.jsx)("button",{className:"btn-neon",disabled:q||!e,onClick:t,children:q?"Promoting...":"Promote"})]})]})]}),(0,g.jsxs)("div",{className:"card-neon",children:[(0,g.jsx)("h3",{className:"font-semibold",children:"Current Admins"}),(0,g.jsxs)("p",{className:"text-sm text-white/70",children:["Total: ",a.length]}),(0,g.jsx)("div",{className:"mt-3 overflow-x-auto",children:(0,g.jsxs)("table",{className:"w-full text-sm",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{className:"text-left text-white/70",children:[(0,g.jsx)("th",{className:"py-2 pr-4",children:"User ID"}),(0,g.jsx)("th",{className:"py-2 pr-4",children:"Role"}),(0,g.jsx)("th",{className:"py-2",children:"is_admin"})]})}),(0,g.jsxs)("tbody",{children:[a.map(a=>(0,g.jsxs)("tr",{className:"border-t border-white/10",children:[(0,g.jsx)("td",{className:"py-2 pr-4 font-mono text-xs",children:a.user_id}),(0,g.jsx)("td",{className:"py-2 pr-4",children:a.role||"—"}),(0,g.jsx)("td",{className:"py-2",children:a.is_admin?"true":"false"})]},a.user_id)),0===a.length&&(0,g.jsx)("tr",{children:(0,g.jsx)("td",{className:"py-3",colSpan:3,children:"No admins found."})})]})]})})]}),m&&(0,g.jsx)("p",{className:"text-sm",children:m})]})]})})}a.s(["default",()=>m],15311);var n=a.i(15311),o=a.i(9193);let p=(0,d.hoist)(n,"default"),q=(0,d.hoist)(n,"getStaticProps"),r=(0,d.hoist)(n,"getStaticPaths"),s=(0,d.hoist)(n,"getServerSideProps"),t=(0,d.hoist)(n,"config"),u=(0,d.hoist)(n,"reportWebVitals"),v=(0,d.hoist)(n,"unstable_getStaticProps"),w=(0,d.hoist)(n,"unstable_getStaticPaths"),x=(0,d.hoist)(n,"unstable_getStaticParams"),y=(0,d.hoist)(n,"unstable_getServerProps"),z=(0,d.hoist)(n,"unstable_getServerSideProps"),A=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/admin/users",pathname:"/admin/users",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:n}),B=(0,o.getHandler)({srcPage:"/admin/users",config:t,userland:n,routeModule:A,getStaticPaths:r,getStaticProps:q,getServerSideProps:s});a.s(["config",0,t,"default",0,p,"getServerSideProps",0,s,"getStaticPaths",0,r,"getStaticProps",0,q,"handler",0,B,"reportWebVitals",0,u,"routeModule",0,A,"unstable_getServerProps",0,y,"unstable_getServerSideProps",0,z,"unstable_getStaticParams",0,x,"unstable_getStaticPaths",0,w,"unstable_getStaticProps",0,v],42178)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a7755af0._.js.map