{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","turbopack:///[project]/app/admin/ops/queue/page.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","'use client'\nimport useSWR from 'swr'\nimport { useCallback, useMemo, useState } from 'react'\n\nconst fetcher = (url: string) => fetch(url).then((r) => r.json())\n\nexport default function QueueDashboardPage() {\n  const { data: stats, mutate: mutateStats } = useSWR('/api/admin/queue/stats', fetcher, { refreshInterval: 5000 })\n  const [status, setStatus] = useState('waiting')\n  const { data: jobs, mutate: mutateJobs } = useSWR(`/api/admin/queue/jobs?status=${status}&limit=20`, fetcher, { refreshInterval: 5000 })\n  const { data: rl } = useSWR('/api/admin/rate-limit/status?scope=admin', fetcher, { refreshInterval: 10000 })\n  const items = useMemo(() => Array.isArray(jobs?.items) ? jobs.items : [], [jobs])\n  const counts = stats?.counts || {}\n\n  const [selectedId, setSelectedId] = useState<string | null>(null)\n  const { data: selected } = useSWR(selectedId ? `/api/admin/queue/job/${selectedId}` : null, fetcher)\n\n  const retry = useCallback(async (id: string) => {\n    await fetch(`/api/admin/queue/job/${id}/retry`, { method: 'POST' })\n    mutateJobs()\n    mutateStats()\n  }, [mutateJobs, mutateStats])\n\n  const remove = useCallback(async (id: string) => {\n    await fetch(`/api/admin/queue/job/${id}`, { method: 'DELETE' })\n    mutateJobs()\n    mutateStats()\n    setSelectedId(null)\n  }, [mutateJobs, mutateStats])\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-semibold mb-4\">Admin Queue Dashboard</h1>\n      <div className=\"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6\">\n        {['waiting','active','completed','failed','delayed','paused'].map((k) => (\n          <div key={k} className=\"rounded-xl bg-white/5 dark:bg-black/20 backdrop-blur-lg p-4 border border-white/10\">\n            <div className=\"text-sm opacity-70\">{k}</div>\n            <div className=\"text-2xl font-bold\">{counts[k] ?? 0}</div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"flex items-center gap-3 mb-4\">\n        <label className=\"text-sm\">Status</label>\n        <select className=\"px-3 py-2 rounded border border-white/10 bg-black/20\" value={status} onChange={(e) => setStatus(e.target.value)}>\n          {['waiting','active','completed','failed','delayed','paused'].map((k) => (<option key={k} value={k}>{k}</option>))}\n        </select>\n      </div>\n\n      <div className=\"rounded-xl bg-white/5 dark:bg-black/20 backdrop-blur-lg border border-white/10\">\n        <table className=\"w-full text-sm\">\n          <thead className=\"text-left\">\n            <tr>\n              <th className=\"p-3\">ID</th>\n              <th className=\"p-3\">Name</th>\n              <th className=\"p-3\">Progress</th>\n              <th className=\"p-3\">State</th>\n              <th className=\"p-3\">Updated</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((j: any) => (\n              <tr key={j.id} className=\"cursor-pointer hover:bg-white/10\" onClick={() => setSelectedId(String(j.id))}>\n                <td className=\"p-3 font-mono text-xs\">{j.id}</td>\n                <td className=\"p-3\">{j.name}</td>\n                <td className=\"p-3\">{typeof j.progress === 'number' ? `${j.progress}%` : ''}</td>\n                <td className=\"p-3\">{j.state}</td>\n                <td className=\"p-3\">{j.processedOn ? new Date(j.processedOn).toLocaleString() : ''}</td>\n              </tr>\n            ))}\n            {items.length === 0 && (\n              <tr><td className=\"p-3\" colSpan={5}>No jobs</td></tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"mt-8\">\n        <h2 className=\"text-xl font-semibold mb-3\">Admin Rate-Limit Buckets</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n          {(Array.isArray(rl?.items) ? rl.items : []).map((it: any) => (\n            <div key={it.key} className=\"rounded-xl bg-white/5 dark:bg-black/20 backdrop-blur-lg p-4 border border-white/10\">\n              <div className=\"font-mono text-xs mb-1\">{it.key}</div>\n              <div className=\"text-sm\">Tokens: {it.tokens}</div>\n              <div className=\"text-xs opacity-70\">Ts: {it.timestamp}</div>\n            </div>\n          ))}\n          {(Array.isArray(rl?.items) ? rl.items : []).length === 0 && <div className=\"text-sm opacity-70\">No buckets</div>}\n        </div>\n      </div>\n\n      {selectedId && selected && (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center\" onClick={() => setSelectedId(null)}>\n          <div className=\"max-w-2xl w-full rounded-xl bg-white/5 dark:bg-black/30 border border-white/10 p-6\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold\">Job {selected.id}</h3>\n              <button className=\"px-3 py-1 rounded bg-white/10\" onClick={() => setSelectedId(null)}>Close</button>\n            </div>\n            <div className=\"grid grid-cols-2 gap-3 mb-4 text-sm\">\n              <div>State: {selected.state}</div>\n              <div>Progress: {typeof selected.progress === 'number' ? `${selected.progress}%` : ''}</div>\n              <div>Attempts: {selected.attemptsMade}</div>\n              <div>Processed: {selected.processedOn ? new Date(selected.processedOn).toLocaleString() : ''}</div>\n              <div>Finished: {selected.finishedOn ? new Date(selected.finishedOn).toLocaleString() : ''}</div>\n            </div>\n            <div className=\"mb-4\">\n              <div className=\"text-sm opacity-70 mb-1\">Data</div>\n              <pre className=\"text-xs bg-black/30 rounded p-3 overflow-auto max-h-40\">{JSON.stringify(selected.data, null, 2)}</pre>\n            </div>\n            <div className=\"mb-4\">\n              <div className=\"text-sm opacity-70 mb-1\">Logs</div>\n              <div className=\"space-y-2 max-h-40 overflow-auto\">\n                {Array.isArray(selected.logs) && selected.logs.map((l: any, i: number) => (\n                  <div key={i} className=\"text-xs bg-black/30 rounded p-2\">{JSON.stringify(l)}</div>\n                ))}\n                {(!selected.logs || selected.logs.length === 0) && <div className=\"text-xs opacity-70\">No logs</div>}\n              </div>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              <button className=\"px-4 py-2 rounded bg-green-600\" onClick={() => retry(String(selected.id))}>Retry</button>\n              <button className=\"px-4 py-2 rounded bg-red-600\" onClick={() => remove(String(selected.id))}>Remove</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"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","ignoreList":[0,1,2]}