module.exports=[94131,(e,t,r)=>{t.exports=e.x("@supabase/supabase-js",()=>require("@supabase/supabase-js"))},30772,e=>{"use strict";let t;var r=e.i(94131);let a=process.env.SUPABASE_URL||"https://wdlcttgfwoejqynlylpv.supabase.co",i=process.env.SUPABASE_SERVICE_ROLE_KEY||"",s=!!(a&&i),n=s?(0,r.createClient)(a,i):{auth:{getUser:t=async()=>{throw Error("supabase_service_not_configured")}},from:()=>({select:t,insert:t,update:t,delete:t,eq:()=>({select:t,insert:t,update:t,delete:t}),order:()=>({select:t}),range:()=>({select:t}),maybeSingle:t})};e.s(["supabaseServer",0,n,"supabaseServiceReady",0,s])},56798,e=>{"use strict";var t=e.i(30772);async function r(e){try{let r=String(e.headers.authorization||""),a=r.startsWith("Bearer ")?r.slice(7):"";if(!a)return{ok:!1,error:"Missing Authorization bearer token"};let{data:i,error:s}=await t.supabaseServer.auth.getUser(a);if(s||!i?.user?.id)return{ok:!1,error:"Invalid token"};let n=i.user.id,{data:o,error:l}=await t.supabaseServer.from("profiles").select("role,is_admin").eq("user_id",n).maybeSingle();if(l)return{ok:!1,error:"Profile lookup failed"};let u=String(o?.role||"").toLowerCase();if(!(o?.is_admin||"admin"===u))return{ok:!1,error:"Forbidden"};return{ok:!0,userId:n}}catch(e){return{ok:!1,error:e?.message||"Admin check failed"}}}e.s(["requireAdmin",()=>r])},55688,e=>{"use strict";var t=e.i(26747),r=e.i(90406),a=e.i(44898),i=e.i(62950),s=e.i(56798),n=e.i(30772);async function o(e,t){if("GET"!==e.method)return t.status(405).json({error:"method_not_allowed"});let r=await (0,s.requireAdmin)(e);if(!r.ok)return t.status(401).json({error:r.error||"unauthorized"});try{let e=await n.supabaseServer.storage.getBucket?.("kyc");if(e?.data?.name==="kyc")return await n.supabaseServer.storage.updateBucket?.("kyc",{public:!1,fileSizeLimit:"10MB",allowedMimeTypes:["image/jpeg","image/png","application/pdf","application/json","text/plain"]}),t.json({ok:!0,bucket:"kyc",updated:!0});let r=await n.supabaseServer.storage.createBucket?.("kyc",{public:!1,fileSizeLimit:"10MB",allowedMimeTypes:["image/jpeg","image/png","application/pdf","application/json","text/plain"]});if(r?.error)return t.status(500).json({error:String(r.error.message||"create_failed")});return t.json({ok:!0,bucket:"kyc",created:!0})}catch(e){return t.status(500).json({error:e?.message||"server_error"})}}e.s(["config",0,{api:{bodyParser:!1}},"default",()=>o],64047);var l=e.i(64047),u=e.i(7031),d=e.i(81927),p=e.i(46432);let c=(0,i.hoist)(l,"default"),g=(0,i.hoist)(l,"config"),m=new a.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/admin/storage/kyc-init",pathname:"/api/admin/storage/kyc-init",bundlePath:"",filename:""},userland:l,distDir:".next",relativeProjectDir:""});async function f(e,r,a){m.isDev&&(0,p.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/admin/storage/kyc-init";i=i.replace(/\/index$/,"")||"/";let s=await m.prepare(e,r,{srcPage:i});if(!s){r.statusCode=400,r.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:n,params:o,prerenderManifest:l,routerServerContext:c}=s;try{let t=e.method||"GET",a=(0,u.getTracer)(),s=a.getActiveScopeSpan(),p=m.instrumentationOnRequestError.bind(m),g=async s=>m.render(e,r,{query:{...n,...o},params:o,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:m.isDev,page:"/api/admin/storage/kyc-init",internalRevalidate:null==c?void 0:c.revalidate,onError:(...t)=>p(e,...t)}).finally(()=>{if(!s)return;s.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=a.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=e.get("next.route");if(n){let e=`${t} ${n}`;s.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),s.updateName(e)}else s.updateName(`${t} ${i}`)});s?await g(s):await a.withPropagatedContext(e.headers,()=>a.trace(d.BaseServerSpan.handleRequest,{spanName:`${t} ${i}`,kind:u.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},g))}catch(e){if(m.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}e.s(["config",0,g,"default",0,c,"handler",()=>f],55688)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__35d4b706._.js.map