{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.SUPABASE_ANON_KEY;\n\nfunction makeStub() {\n  const noop = async () => ({ data: null, error: new Error('Supabase not configured') });\n  const auth = {\n    getSession: async () => ({ data: { session: null } }),\n    onAuthStateChange: () => ({ data: { subscription: { unsubscribe: () => {} } } }),\n    signUp: async () => ({ data: null, error: new Error('Supabase not configured') }),\n    signInWithPassword: async () => ({ data: null, error: new Error('Supabase not configured') })\n  };\n  const query = {\n    select: () => ({ eq: () => ({ limit: () => ({ maybeSingle: noop }) }), maybeSingle: noop }),\n    upsert: () => ({ select: noop }),\n    eq: () => ({ select: noop }),\n  } as any;\n  return { auth, from: () => query } as any;\n}\n\nexport const supabase = (supabaseUrl && supabaseAnonKey)\n  ? createClient(supabaseUrl, supabaseAnonKey, { auth: { persistSession: true, autoRefreshToken: true } })\n  : makeStub();\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC,QAAQ,GAAG,CAAC,YAAY;AACpF,MAAM,kBAAkB,wPAA6C,QAAQ,GAAG,CAAC,iBAAiB;AAElG,SAAS;IACP,MAAM,OAAO,UAAY,CAAC;YAAE,MAAM;YAAM,OAAO,IAAI,MAAM;QAA2B,CAAC;IACrF,MAAM,OAAO;QACX,YAAY,UAAY,CAAC;gBAAE,MAAM;oBAAE,SAAS;gBAAK;YAAE,CAAC;QACpD,mBAAmB,IAAM,CAAC;gBAAE,MAAM;oBAAE,cAAc;wBAAE,aAAa,KAAO;oBAAE;gBAAE;YAAE,CAAC;QAC/E,QAAQ,UAAY,CAAC;gBAAE,MAAM;gBAAM,OAAO,IAAI,MAAM;YAA2B,CAAC;QAChF,oBAAoB,UAAY,CAAC;gBAAE,MAAM;gBAAM,OAAO,IAAI,MAAM;YAA2B,CAAC;IAC9F;IACA,MAAM,QAAQ;QACZ,QAAQ,IAAM,CAAC;gBAAE,IAAI,IAAM,CAAC;wBAAE,OAAO,IAAM,CAAC;gCAAE,aAAa;4BAAK,CAAC;oBAAE,CAAC;gBAAG,aAAa;YAAK,CAAC;QAC1F,QAAQ,IAAM,CAAC;gBAAE,QAAQ;YAAK,CAAC;QAC/B,IAAI,IAAM,CAAC;gBAAE,QAAQ;YAAK,CAAC;IAC7B;IACA,OAAO;QAAE;QAAM,MAAM,IAAM;IAAM;AACnC;AAEO,MAAM,WAAW,uCACpB,IAAA,iKAAY,EAAC,aAAa,iBAAiB;IAAE,MAAM;QAAE,gBAAgB;QAAM,kBAAkB;IAAK;AAAE,KACpG","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/components/AdminGuard.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { supabase } from '../lib/supabase';\n\ntype Profile = { role?: string | null; is_admin?: boolean | null };\n\nexport default function AdminGuard({ children }: { children: React.ReactNode }) {\n  const [status, setStatus] = useState<'loading' | 'noauth' | 'forbidden' | 'ok'>('loading');\n\n  useEffect(() => {\n    let mounted = true;\n    async function check() {\n      const { data } = await supabase.auth.getSession();\n      const user = data.session?.user;\n      if (!user) {\n        if (mounted) setStatus('noauth');\n        return;\n      }\n      const { data: profile } = await supabase\n        .from('profiles')\n        .select('role,is_admin')\n        .eq('user_id', user.id)\n        .maybeSingle();\n      const p = profile as Profile | null;\n      const isAdmin = Boolean(p?.is_admin) || String(p?.role || '').toLowerCase() === 'admin';\n      if (mounted) setStatus(isAdmin ? 'ok' : 'forbidden');\n    }\n    check();\n    return () => { mounted = false; };\n  }, []);\n\n  if (status === 'loading') return <div className=\"p-6\">Checking permissionsâ€¦</div>;\n  if (status === 'noauth') return <div className=\"p-6\">Sign in required.</div>;\n  if (status === 'forbidden') return <div className=\"p-6\">Not authorized.</div>;\n  return <>{children}</>;\n}\n\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAIe,SAAS,WAAW,EAAE,QAAQ,EAAiC;IAC5E,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAA4C;IAEhF,IAAA,gHAAS,EAAC;QACR,IAAI,UAAU;QACd,eAAe;YACb,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,uKAAQ,CAAC,IAAI,CAAC,UAAU;YAC/C,MAAM,OAAO,KAAK,OAAO,EAAE;YAC3B,IAAI,CAAC,MAAM;gBACT,IAAI,SAAS,UAAU;gBACvB;YACF;YACA,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,uKAAQ,CACrC,IAAI,CAAC,YACL,MAAM,CAAC,iBACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,WAAW;YACd,MAAM,IAAI;YACV,MAAM,UAAU,QAAQ,GAAG,aAAa,OAAO,GAAG,QAAQ,IAAI,WAAW,OAAO;YAChF,IAAI,SAAS,UAAU,UAAU,OAAO;QAC1C;QACA;QACA,OAAO;YAAQ,UAAU;QAAO;IAClC,GAAG,EAAE;IAEL,IAAI,WAAW,WAAW,qBAAO,qKAAC;QAAI,WAAU;kBAAM;;;;;;IACtD,IAAI,WAAW,UAAU,qBAAO,qKAAC;QAAI,WAAU;kBAAM;;;;;;IACrD,IAAI,WAAW,aAAa,qBAAO,qKAAC;QAAI,WAAU;kBAAM;;;;;;IACxD,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/pages/admin/performance.tsx"],"sourcesContent":["import { useState } from 'react';\nimport AdminGuard from '../../components/AdminGuard';\nimport { supabase } from '../../lib/supabase';\n\nconst defaultStreams = { trading: 0, copy_trading: 0, staking_yield: 0, ads_tasks: 0, ai: 0 };\n\nexport default function AdminPerformance() {\n  const [weekEnding, setWeekEnding] = useState<string>('');\n  const [streams, setStreams] = useState<Record<string, number>>(defaultStreams);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n\n  function updateStream(key: string, value: string) {\n    setStreams(s => ({ ...s, [key]: Number(value) || 0 }));\n  }\n\n  async function submit() {\n    setLoading(true);\n    setMessage('');\n    try {\n      const { data } = await supabase.auth.getSession();\n      const token = data.session?.access_token;\n      if (!token) throw new Error('Missing session token. Please sign in again.');\n\n      const res = await fetch('/api/admin/performance', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },\n        body: JSON.stringify({ weekEnding, streamRois: streams })\n      });\n      const payload = await res.json();\n      if (!res.ok) throw new Error(payload?.error || 'Failed');\n      setMessage('Saved performance for ' + weekEnding);\n    } catch (e: any) {\n      setMessage(e?.message || 'Error');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <AdminGuard>\n    <div className=\"max-w-2xl mx-auto p-6\">\n      <h1 className=\"text-2xl font-semibold mb-4\">Admin: Weekly Performance Streams</h1>\n      <div className=\"mb-4\">\n        <label className=\"block text-sm font-medium mb-1\">Week Ending</label>\n        <input type=\"date\" className=\"w-full border rounded p-2\" value={weekEnding} onChange={e => setWeekEnding(e.target.value)} />\n      </div>\n      <div className=\"grid grid-cols-1 gap-4\">\n        {Object.keys(streams).map(key => (\n          <div key={key}>\n            <label className=\"block text-sm font-medium mb-1\">{(key.replace('_', ' ').toUpperCase())} ROI %</label>\n            <input type=\"number\" step=\"0.01\" className=\"w-full border rounded p-2 text-black\" value={streams[key]}\n              onChange={e => updateStream(key, e.target.value)} />\n          </div>\n        ))}\n      </div>\n      <button className=\"mt-6 bg-blue-600 text-white px-4 py-2 rounded\" disabled={loading || !weekEnding} onClick={submit}>\n        {loading ? 'Saving...' : 'Save Performance'}\n      </button>\n      {message && <p className=\"mt-3 text-sm\">{message}</p>}\n      <div className=\"mt-8\">\n        <p className=\"text-xs text-gray-500\">Streams: Trading, Copy-Trading, Staking/Yield, Ads & Tasks, AI. Enter weekly ROI percentages per stream. Then trigger profit distribution via POST /api/admin/distribute-profits.</p>\n      </div>\n    </div>\n    </AdminGuard>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEA,MAAM,iBAAiB;IAAE,SAAS;IAAG,cAAc;IAAG,eAAe;IAAG,WAAW;IAAG,IAAI;AAAE;AAE7E,SAAS;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+GAAQ,EAAS;IACrD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAyB;IAC/D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,SAAS,aAAa,GAAW,EAAE,KAAa;QAC9C,WAAW,CAAA,IAAK,CAAC;gBAAE,GAAG,CAAC;gBAAE,CAAC,IAAI,EAAE,OAAO,UAAU;YAAE,CAAC;IACtD;IAEA,eAAe;QACb,WAAW;QACX,WAAW;QACX,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,uKAAQ,CAAC,IAAI,CAAC,UAAU;YAC/C,MAAM,QAAQ,KAAK,OAAO,EAAE;YAC5B,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;YAE5B,MAAM,MAAM,MAAM,MAAM,0BAA0B;gBAChD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;oBAAoB,iBAAiB,CAAC,OAAO,EAAE,OAAO;gBAAC;gBAClF,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAY,YAAY;gBAAQ;YACzD;YACA,MAAM,UAAU,MAAM,IAAI,IAAI;YAC9B,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,SAAS,SAAS;YAC/C,WAAW,2BAA2B;QACxC,EAAE,OAAO,GAAQ;YACf,WAAW,GAAG,WAAW;QAC3B,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,qKAAC,gLAAU;kBACX,cAAA,qKAAC;YAAI,WAAU;;8BACb,qKAAC;oBAAG,WAAU;8BAA8B;;;;;;8BAC5C,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAM,WAAU;sCAAiC;;;;;;sCAClD,qKAAC;4BAAM,MAAK;4BAAO,WAAU;4BAA4B,OAAO;4BAAY,UAAU,CAAA,IAAK,cAAc,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;8BAEzH,qKAAC;oBAAI,WAAU;8BACZ,OAAO,IAAI,CAAC,SAAS,GAAG,CAAC,CAAA,oBACxB,qKAAC;;8CACC,qKAAC;oCAAM,WAAU;;wCAAmC,IAAI,OAAO,CAAC,KAAK,KAAK,WAAW;wCAAI;;;;;;;8CACzF,qKAAC;oCAAM,MAAK;oCAAS,MAAK;oCAAO,WAAU;oCAAuC,OAAO,OAAO,CAAC,IAAI;oCACnG,UAAU,CAAA,IAAK,aAAa,KAAK,EAAE,MAAM,CAAC,KAAK;;;;;;;2BAHzC;;;;;;;;;;8BAOd,qKAAC;oBAAO,WAAU;oBAAgD,UAAU,WAAW,CAAC;oBAAY,SAAS;8BAC1G,UAAU,cAAc;;;;;;gBAE1B,yBAAW,qKAAC;oBAAE,WAAU;8BAAgB;;;;;;8BACzC,qKAAC;oBAAI,WAAU;8BACb,cAAA,qKAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;;;;;;;;;;;;AAK7C","debugId":null}}]
}