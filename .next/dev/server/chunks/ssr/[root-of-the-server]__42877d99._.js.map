{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.SUPABASE_ANON_KEY;\n\nfunction makeStub() {\n  const noop = async () => ({ data: null, error: new Error('Supabase not configured') });\n  const auth = {\n    getSession: async () => ({ data: { session: null } }),\n    onAuthStateChange: () => ({ data: { subscription: { unsubscribe: () => {} } } }),\n    signUp: async () => ({ data: null, error: new Error('Supabase not configured') }),\n    signInWithPassword: async () => ({ data: null, error: new Error('Supabase not configured') })\n  };\n  const query = {\n    select: () => ({ eq: () => ({ limit: () => ({ maybeSingle: noop }) }), maybeSingle: noop }),\n    upsert: () => ({ select: noop }),\n    eq: () => ({ select: noop }),\n  } as any;\n  return { auth, from: () => query } as any;\n}\n\nexport const supabase = (supabaseUrl && supabaseAnonKey)\n  ? createClient(supabaseUrl, supabaseAnonKey, { auth: { persistSession: true, autoRefreshToken: true } })\n  : makeStub();\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC,QAAQ,GAAG,CAAC,YAAY;AACpF,MAAM,kBAAkB,wPAA6C,QAAQ,GAAG,CAAC,iBAAiB;AAElG,SAAS;IACP,MAAM,OAAO,UAAY,CAAC;YAAE,MAAM;YAAM,OAAO,IAAI,MAAM;QAA2B,CAAC;IACrF,MAAM,OAAO;QACX,YAAY,UAAY,CAAC;gBAAE,MAAM;oBAAE,SAAS;gBAAK;YAAE,CAAC;QACpD,mBAAmB,IAAM,CAAC;gBAAE,MAAM;oBAAE,cAAc;wBAAE,aAAa,KAAO;oBAAE;gBAAE;YAAE,CAAC;QAC/E,QAAQ,UAAY,CAAC;gBAAE,MAAM;gBAAM,OAAO,IAAI,MAAM;YAA2B,CAAC;QAChF,oBAAoB,UAAY,CAAC;gBAAE,MAAM;gBAAM,OAAO,IAAI,MAAM;YAA2B,CAAC;IAC9F;IACA,MAAM,QAAQ;QACZ,QAAQ,IAAM,CAAC;gBAAE,IAAI,IAAM,CAAC;wBAAE,OAAO,IAAM,CAAC;gCAAE,aAAa;4BAAK,CAAC;oBAAE,CAAC;gBAAG,aAAa;YAAK,CAAC;QAC1F,QAAQ,IAAM,CAAC;gBAAE,QAAQ;YAAK,CAAC;QAC/B,IAAI,IAAM,CAAC;gBAAE,QAAQ;YAAK,CAAC;IAC7B;IACA,OAAO;QAAE;QAAM,MAAM,IAAM;IAAM;AACnC;AAEO,MAAM,WAAW,uCACpB,IAAA,iKAAY,EAAC,aAAa,iBAAiB;IAAE,MAAM;QAAE,gBAAgB;QAAM,kBAAkB;IAAK;AAAE,KACpG","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/components/RequireAuth.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { supabase } from '../lib/supabase';\nimport { useRouter } from 'next/router';\n\ntype Props = { children: React.ReactNode };\n\nexport default function RequireAuth({ children }: Props) {\n  const router = useRouter();\n  const [ready, setReady] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n    supabase.auth.getSession().then((res: { data: { session: any } }) => {\n      const isAuthed = !!res.data?.session;\n      if (!isAuthed) {\n        router.replace('/auth/login');\n      } else if (mounted) {\n        setReady(true);\n      }\n    });\n    const { data: sub } = supabase.auth.onAuthStateChange((_event: any, session: any) => {\n      if (!session) router.replace('/auth/login');\n    });\n    return () => { sub?.subscription?.unsubscribe(); mounted = false; };\n  }, [router]);\n\n  if (!ready) {\n    return (\n      <div className=\"card-neon text-center\">\n        <p>Checking your session...</p>\n      </div>\n    );\n  }\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAIe,SAAS,YAAY,EAAE,QAAQ,EAAS;IACrD,MAAM,SAAS,IAAA,uLAAS;IACxB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IAEnC,IAAA,gHAAS,EAAC;QACR,IAAI,UAAU;QACd,uKAAQ,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC;YAC/B,MAAM,WAAW,CAAC,CAAC,IAAI,IAAI,EAAE;YAC7B,IAAI,CAAC,UAAU;gBACb,OAAO,OAAO,CAAC;YACjB,OAAO,IAAI,SAAS;gBAClB,SAAS;YACX;QACF;QACA,MAAM,EAAE,MAAM,GAAG,EAAE,GAAG,uKAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,QAAa;YAClE,IAAI,CAAC,SAAS,OAAO,OAAO,CAAC;QAC/B;QACA,OAAO;YAAQ,KAAK,cAAc;YAAe,UAAU;QAAO;IACpE,GAAG;QAAC;KAAO;IAEX,IAAI,CAAC,OAAO;QACV,qBACE,qKAAC;YAAI,WAAU;sBACb,cAAA,qKAAC;0BAAE;;;;;;;;;;;IAGT;IACA,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/lib/db.ts"],"sourcesContent":["import { supabase } from './supabase';\n\nexport type WalletRow = {\n  id: string;\n  user_id: string;\n  currency: 'USD' | 'EUR' | 'NGN' | 'BTC' | 'ETH';\n  balance: number;\n};\n\nexport type InvestmentRow = {\n  id: string;\n  user_id: string;\n  plan_id: 'starter' | 'pro' | 'elite';\n  amount_usd: number;\n  status: 'active' | 'completed' | 'pending';\n};\n\nexport async function getCurrentUserId(): Promise<string | null> {\n  const { data } = await supabase.auth.getSession();\n  return data.session?.user?.id ?? null;\n}\n\nexport async function getUserWallets(userId: string): Promise<WalletRow[]> {\n  // First try client-side read (requires RLS policies). If empty or blocked, fallback to server API.\n  const { data, error } = await supabase\n    .from('wallets')\n    .select('id,user_id,currency,balance')\n    .eq('user_id', userId);\n  const direct = (data ?? []) as WalletRow[];\n  if (!error && direct.length > 0) return direct;\n  try {\n    const { data: session } = await supabase.auth.getSession();\n    const token = session.session?.access_token;\n    if (!token) return direct; // cannot fallback without token\n    const res = await fetch(`/api/user/wallets?ts=${Date.now()}`, {\n      headers: { Authorization: `Bearer ${token}` },\n      // Ensure no caching by intermediaries\n      cache: 'no-store',\n    });\n    if (!res.ok) return direct;\n    const payload = await res.json();\n    return (payload.wallets ?? []) as WalletRow[];\n  } catch {\n    return direct;\n  }\n}\n\nexport async function getUserInvestments(userId: string): Promise<InvestmentRow[]> {\n  const { data, error } = await supabase\n    .from('investments')\n    .select('id,user_id,plan_id,amount_usd,status')\n    .eq('user_id', userId);\n  if (error) return [];\n  return (data ?? []) as InvestmentRow[];\n}\n\nexport async function upsertReferral(userId: string, code: string) {\n  const { data, error } = await supabase\n    .from('referrals')\n    .upsert({ user_id: userId, code }, { onConflict: 'user_id' })\n    .select();\n  if (error) return null;\n  return data?.[0] ?? null;\n}\n\nexport async function getReferralByUser(userId: string) {\n  const { data } = await supabase\n    .from('referrals')\n    .select('code,total_earnings')\n    .eq('user_id', userId)\n    .limit(1)\n    .maybeSingle();\n  return data ?? null;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAiBO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,uKAAQ,CAAC,IAAI,CAAC,UAAU;IAC/C,OAAO,KAAK,OAAO,EAAE,MAAM,MAAM;AACnC;AAEO,eAAe,eAAe,MAAc;IACjD,mGAAmG;IACnG,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uKAAQ,CACnC,IAAI,CAAC,WACL,MAAM,CAAC,+BACP,EAAE,CAAC,WAAW;IACjB,MAAM,SAAU,QAAQ,EAAE;IAC1B,IAAI,CAAC,SAAS,OAAO,MAAM,GAAG,GAAG,OAAO;IACxC,IAAI;QACF,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,uKAAQ,CAAC,IAAI,CAAC,UAAU;QACxD,MAAM,QAAQ,QAAQ,OAAO,EAAE;QAC/B,IAAI,CAAC,OAAO,OAAO,QAAQ,gCAAgC;QAC3D,MAAM,MAAM,MAAM,MAAM,CAAC,qBAAqB,EAAE,KAAK,GAAG,IAAI,EAAE;YAC5D,SAAS;gBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAC;YAC5C,sCAAsC;YACtC,OAAO;QACT;QACA,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;QACpB,MAAM,UAAU,MAAM,IAAI,IAAI;QAC9B,OAAQ,QAAQ,OAAO,IAAI,EAAE;IAC/B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,mBAAmB,MAAc;IACrD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uKAAQ,CACnC,IAAI,CAAC,eACL,MAAM,CAAC,wCACP,EAAE,CAAC,WAAW;IACjB,IAAI,OAAO,OAAO,EAAE;IACpB,OAAQ,QAAQ,EAAE;AACpB;AAEO,eAAe,eAAe,MAAc,EAAE,IAAY;IAC/D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uKAAQ,CACnC,IAAI,CAAC,aACL,MAAM,CAAC;QAAE,SAAS;QAAQ;IAAK,GAAG;QAAE,YAAY;IAAU,GAC1D,MAAM;IACT,IAAI,OAAO,OAAO;IAClB,OAAO,MAAM,CAAC,EAAE,IAAI;AACtB;AAEO,eAAe,kBAAkB,MAAc;IACpD,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,uKAAQ,CAC5B,IAAI,CAAC,aACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,GACN,WAAW;IACd,OAAO,QAAQ;AACjB","debugId":null}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/trae_projects/HYBRID%20TRADE%20AI/pages/profile.tsx"],"sourcesContent":["import RequireAuth from '../components/RequireAuth';\nimport { useEffect, useState } from 'react';\nimport { getCurrentUserId, getReferralByUser } from '../lib/db';\n\nexport default function Profile() {\n  const [userId, setUserId] = useState<string | null>(null);\n  const [referralCode, setReferralCode] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [copied, setCopied] = useState(false);\n  const [shareError, setShareError] = useState<string>('');\n\n  useEffect(() => {\n    (async () => {\n      const id = await getCurrentUserId();\n      setUserId(id);\n      if (id) {\n        const ref = await getReferralByUser(id);\n        if (ref?.code) setReferralCode(ref.code);\n      }\n    })();\n  }, []);\n\n  const generateReferral = async () => {\n    if (!userId) return;\n    try {\n      setLoading(true);\n      const res = await fetch('/api/referral', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId })\n      });\n      const data = await res.json();\n      setReferralCode(data.referralCode);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';\n  const referralLink = referralCode ? `${siteUrl}/auth/register?ref=${referralCode}` : '';\n\n  const copyLink = async () => {\n    if (!referralLink) return;\n    try {\n      await navigator.clipboard.writeText(referralLink);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 1500);\n    } catch {}\n  };\n\n  const shareLink = async () => {\n    if (!referralLink) return;\n    setShareError('');\n    try {\n      if (navigator.share) {\n        await navigator.share({ title: 'Join HybridTradeAI', url: referralLink });\n      } else {\n        await navigator.clipboard.writeText(referralLink);\n        setCopied(true);\n        setTimeout(() => setCopied(false), 1500);\n      }\n    } catch (e: any) {\n      setShareError(e?.message || 'Unable to share');\n    }\n  };\n\n  return (\n    <RequireAuth>\n      <div className=\"max-w-xl mx-auto space-y-6\">\n        <div className=\"card-neon\">\n          <h2 className=\"text-2xl font-bold neon-text\">Your Profile</h2>\n          <p className=\"mt-2 text-sm text-white/80\">User ID: {userId}</p>\n        </div>\n        <div className=\"card-neon\">\n          <h3 className=\"font-semibold\">Referral</h3>\n          {referralCode ? (\n            <div className=\"mt-2\">\n              <p className=\"text-sm\">Code: <span className=\"text-neon-blue\">{referralCode}</span></p>\n              <p className=\"text-sm break-all\">Link: <a className=\"text-neon-blue\" href={referralLink}>{referralLink}</a></p>\n              <div className=\"mt-3 flex gap-3\">\n                <button className=\"btn-neon\" onClick={copyLink}>Copy Link</button>\n                <button className=\"btn-neon\" onClick={shareLink}>Share</button>\n              </div>\n              {copied && <p className=\"mt-2 text-xs text-neon-blue\">Copied!</p>}\n              {shareError && <p className=\"mt-2 text-xs text-red-400\">{shareError}</p>}\n            </div>\n          ) : (\n            <button className=\"btn-neon mt-3\" onClick={generateReferral} disabled={loading}>\n              {loading ? 'Generating...' : 'Generate Referral Code'}\n            </button>\n          )}\n        </div>\n      </div>\n    </RequireAuth>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAgB;IACpD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAAgB;IAChE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC;IACrC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+GAAQ,EAAS;IAErD,IAAA,gHAAS,EAAC;QACR,CAAC;YACC,MAAM,KAAK,MAAM,IAAA,yKAAgB;YACjC,UAAU;YACV,IAAI,IAAI;gBACN,MAAM,MAAM,MAAM,IAAA,0KAAiB,EAAC;gBACpC,IAAI,KAAK,MAAM,gBAAgB,IAAI,IAAI;YACzC;QACF,CAAC;IACH,GAAG,EAAE;IAEL,MAAM,mBAAmB;QACvB,IAAI,CAAC,QAAQ;QACb,IAAI;YACF,WAAW;YACX,MAAM,MAAM,MAAM,MAAM,iBAAiB;gBACvC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAO;YAChC;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,gBAAgB,KAAK,YAAY;QACnC,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,UAAU,6DAAoC;IACpD,MAAM,eAAe,eAAe,GAAG,QAAQ,mBAAmB,EAAE,cAAc,GAAG;IAErF,MAAM,WAAW;QACf,IAAI,CAAC,cAAc;QACnB,IAAI;YACF,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;YACpC,UAAU;YACV,WAAW,IAAM,UAAU,QAAQ;QACrC,EAAE,OAAM,CAAC;IACX;IAEA,MAAM,YAAY;QAChB,IAAI,CAAC,cAAc;QACnB,cAAc;QACd,IAAI;YACF,IAAI,UAAU,KAAK,EAAE;gBACnB,MAAM,UAAU,KAAK,CAAC;oBAAE,OAAO;oBAAsB,KAAK;gBAAa;YACzE,OAAO;gBACL,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;gBACpC,UAAU;gBACV,WAAW,IAAM,UAAU,QAAQ;YACrC;QACF,EAAE,OAAO,GAAQ;YACf,cAAc,GAAG,WAAW;QAC9B;IACF;IAEA,qBACE,qKAAC,iLAAW;kBACV,cAAA,qKAAC;YAAI,WAAU;;8BACb,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAG,WAAU;sCAA+B;;;;;;sCAC7C,qKAAC;4BAAE,WAAU;;gCAA6B;gCAAU;;;;;;;;;;;;;8BAEtD,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAG,WAAU;sCAAgB;;;;;;wBAC7B,6BACC,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAE,WAAU;;wCAAU;sDAAM,qKAAC;4CAAK,WAAU;sDAAkB;;;;;;;;;;;;8CAC/D,qKAAC;oCAAE,WAAU;;wCAAoB;sDAAM,qKAAC;4CAAE,WAAU;4CAAiB,MAAM;sDAAe;;;;;;;;;;;;8CAC1F,qKAAC;oCAAI,WAAU;;sDACb,qKAAC;4CAAO,WAAU;4CAAW,SAAS;sDAAU;;;;;;sDAChD,qKAAC;4CAAO,WAAU;4CAAW,SAAS;sDAAW;;;;;;;;;;;;gCAElD,wBAAU,qKAAC;oCAAE,WAAU;8CAA8B;;;;;;gCACrD,4BAAc,qKAAC;oCAAE,WAAU;8CAA6B;;;;;;;;;;;iDAG3D,qKAAC;4BAAO,WAAU;4BAAgB,SAAS;4BAAkB,UAAU;sCACpE,UAAU,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;AAO3C","debugId":null}}]
}